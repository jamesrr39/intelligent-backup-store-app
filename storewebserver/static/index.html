<html>
	<head>
		<title>Store</title>
		<link rel="stylesheet" href="/libs/bootstrap-4.0.0-alpha.6.css" />
		<script src="/libs/jquery-3.2.1.js"></script>
		<script src="/libs/handlebars-4.0.10.js"></script>
	</head>
	<body>
		Store webapp
		
		<div id="content">
			
		</div>
		
		
		
		<script>
		
		var bucketListTemplate = Handlebars.compile("<table class='table'>{{#buckets}}<tr><td>{{name}}</td></tr>{{/buckets}}<tbody></tbody></table>");
		
		var errTemplate = Handlebars.compile("<div class='alert alert-danger'>{{message}}</div>");
		
		function renderBucketListing(buckets) {	
			document.getElementById("content").innerHTML = bucketListTemplate({buckets: buckets});
		}
			
		$.ajax("/api/buckets/").then(function(buckets){

			window.onhashchange = function(){
				var hash = window.location.hash;
				
				if (hash.startsWith("#/buckets")) {
					renderBucketListing(buckets);
				}
			}
			
			// render start screen depending on start hash location
			window.onhashchange();
		}).fail(function(xhr) {
			document.getElementById("content").innerHTML = errTemplate({message: "Error fetching buckets data: " + xhr.responseText});
		});
		</script>
	</body>
</html>
